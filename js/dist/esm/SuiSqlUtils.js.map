{
  "version": 3,
  "sources": ["../../src/SuiSqlUtils.ts"],
  "sourcesContent": ["import pako from 'pako';\n\n/**\n * Compress Uint8Array\n */\nconst compress = async (input: Uint8Array): Promise<Uint8Array> => {\n    return pako.deflate(input);\n};\n\n/**\n * Decompress zlib compresses Uint8Array\n */\nconst decompress = async (compressed: Uint8Array): Promise<Uint8Array> => {\n    return pako.inflate(compressed);\n}\n\n/**\n * Makes a shallow copy of object, array or primitive\n */\nconst anyShallowCopy = (input: Object|Array<any>|any): Object|Array<any>|any => {\n    if (Array.isArray(input)) {\n        return [...input]; // Shallow copy of array\n    } else if (typeof input === 'object' && input !== null) {\n        return { ...input }; // Shallow copy of object\n    } else {\n        return input; // Return as is for non-objects (primitives)\n    }\n};\n\n/**\n * Determine if SQL statement 100% updates database state\n */\nconst isSureWriteSql = (sql: string) => {\n    const checks = ['CREATE', 'ALTER', 'INSERT', 'UPDATE', 'DELETE', 'DROP'];\n    for (const check of checks) {\n        if (sql.trim().toUpperCase().startsWith(check)) {\n            return true;\n        }\n    }\n    return false;\n};\n\nconst getFieldsFromCreateTableSql = (sql: string): Array<string> | null => {\n    const inParentheses = extractTopLevelParenthesesText( sql.split(\"\\n\").join(' ') );\n\n    if (!inParentheses || !inParentheses[0]) {\n        return null;\n    }\n    const fields = inParentheses[0].split(',');\n\n    const ret = [];\n    for (const field of fields) {\n        const definition = field.trim().toLowerCase();\n        ret.push(definition);\n    }\n\n    console.log(ret);\n    console.log(ret);\n\n    return ret;\n};\n\n\nconst extractTopLevelParenthesesText = (str: string): Array<string> => {\n    let result = [];\n    let stack = [];\n    let startIndex = -1;\n\n    for (let i = 0; i < str.length; i++) {\n        if (str[i] === '(') {\n            if (stack.length === 0) {\n                startIndex = i + 1; // Start after '('\n            }\n            stack.push('(');\n        } else if (str[i] === ')') {\n            stack.pop();\n            if (stack.length === 0 && startIndex !== -1) {\n                result.push(str.substring(startIndex, i));\n                startIndex = -1; // Reset for the next top-level match\n            }\n        }\n    }\n\n    return result;\n}\n\nconst int32ToUint8ArrayBE = (num: number) => Uint8Array.from([num >>> 24, num >>> 16 & 0xff, num >>> 8 & 0xff, num & 0xff]);\n\n\nconst concatUint8Arrays = (arrays: Uint8Array[]) => {\n    const totalLength = arrays.reduce((sum, arr) => sum + arr.length, 0);\n    const result = new Uint8Array(totalLength);\n    let offset = 0;\n    for (const arr of arrays) {\n        result.set(arr, offset);\n        offset += arr.length;\n    }\n    return result;\n};\n\nexport { \n    anyShallowCopy, \n    isSureWriteSql, \n    compress, \n    decompress,\n    getFieldsFromCreateTableSql,\n    int32ToUint8ArrayBE,\n    concatUint8Arrays,\n};"],
  "mappings": "AAAA,OAAO,UAAU;AAKjB,MAAM,WAAW,OAAO,UAA2C;AAC/D,SAAO,KAAK,QAAQ,KAAK;AAC7B;AAKA,MAAM,aAAa,OAAO,eAAgD;AACtE,SAAO,KAAK,QAAQ,UAAU;AAClC;AAKA,MAAM,iBAAiB,CAAC,UAAwD;AAC5E,MAAI,MAAM,QAAQ,KAAK,GAAG;AACtB,WAAO,CAAC,GAAG,KAAK;AAAA,EACpB,WAAW,OAAO,UAAU,YAAY,UAAU,MAAM;AACpD,WAAO,EAAE,GAAG,MAAM;AAAA,EACtB,OAAO;AACH,WAAO;AAAA,EACX;AACJ;AAKA,MAAM,iBAAiB,CAAC,QAAgB;AACpC,QAAM,SAAS,CAAC,UAAU,SAAS,UAAU,UAAU,UAAU,MAAM;AACvE,aAAW,SAAS,QAAQ;AACxB,QAAI,IAAI,KAAK,EAAE,YAAY,EAAE,WAAW,KAAK,GAAG;AAC5C,aAAO;AAAA,IACX;AAAA,EACJ;AACA,SAAO;AACX;AAEA,MAAM,8BAA8B,CAAC,QAAsC;AACvE,QAAM,gBAAgB,+BAAgC,IAAI,MAAM,IAAI,EAAE,KAAK,GAAG,CAAE;AAEhF,MAAI,CAAC,iBAAiB,CAAC,cAAc,CAAC,GAAG;AACrC,WAAO;AAAA,EACX;AACA,QAAM,SAAS,cAAc,CAAC,EAAE,MAAM,GAAG;AAEzC,QAAM,MAAM,CAAC;AACb,aAAW,SAAS,QAAQ;AACxB,UAAM,aAAa,MAAM,KAAK,EAAE,YAAY;AAC5C,QAAI,KAAK,UAAU;AAAA,EACvB;AAEA,UAAQ,IAAI,GAAG;AACf,UAAQ,IAAI,GAAG;AAEf,SAAO;AACX;AAGA,MAAM,iCAAiC,CAAC,QAA+B;AACnE,MAAI,SAAS,CAAC;AACd,MAAI,QAAQ,CAAC;AACb,MAAI,aAAa;AAEjB,WAAS,IAAI,GAAG,IAAI,IAAI,QAAQ,KAAK;AACjC,QAAI,IAAI,CAAC,MAAM,KAAK;AAChB,UAAI,MAAM,WAAW,GAAG;AACpB,qBAAa,IAAI;AAAA,MACrB;AACA,YAAM,KAAK,GAAG;AAAA,IAClB,WAAW,IAAI,CAAC,MAAM,KAAK;AACvB,YAAM,IAAI;AACV,UAAI,MAAM,WAAW,KAAK,eAAe,IAAI;AACzC,eAAO,KAAK,IAAI,UAAU,YAAY,CAAC,CAAC;AACxC,qBAAa;AAAA,MACjB;AAAA,IACJ;AAAA,EACJ;AAEA,SAAO;AACX;AAEA,MAAM,sBAAsB,CAAC,QAAgB,WAAW,KAAK,CAAC,QAAQ,IAAI,QAAQ,KAAK,KAAM,QAAQ,IAAI,KAAM,MAAM,GAAI,CAAC;AAG1H,MAAM,oBAAoB,CAAC,WAAyB;AAChD,QAAM,cAAc,OAAO,OAAO,CAAC,KAAK,QAAQ,MAAM,IAAI,QAAQ,CAAC;AACnE,QAAM,SAAS,IAAI,WAAW,WAAW;AACzC,MAAI,SAAS;AACb,aAAW,OAAO,QAAQ;AACtB,WAAO,IAAI,KAAK,MAAM;AACtB,cAAU,IAAI;AAAA,EAClB;AACA,SAAO;AACX;",
  "names": []
}
